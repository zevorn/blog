@tailwind base;
@tailwind components;
@tailwind utilities;

/* KaTeX 数学公式样式 */
@import 'katex/dist/katex.min.css';

:root {
  --brand: theme('colors.orange.600');
  --text-1: theme('colors.slate.800');
  --text-2: theme('colors.slate.700');
  --text-3: theme('colors.slate.600');
  --text-4: theme('colors.slate.500');
  --surface: theme('colors.white');
  --surface-1: theme('colors.slate.50');
  --surface-2: theme('colors.slate.100');
  --surface-3: theme('colors.slate.200');
  --surface-4: theme('colors.slate.300');

  --border: #e5e7eb;

  --font-remote: var(--font-remote-sans);
}

:root.dark {
  --brand: theme('colors.slate.200');
  --text-1: theme('colors.slate.50');
  --text-2: theme('colors.slate.100');
  --text-3: theme('colors.slate.200');
  --text-4: theme('colors.slate.300');
  --surface: #000212;
  --surface-1: theme('colors.slate.800');
  --surface-2: theme('colors.slate.700');
  --surface-3: theme('colors.slate.600');
  --surface-4: theme('colors.slate.500');

  --border: theme('colors.slate.700');

  .shiki,
  .shiki span {
    color: var(--shiki-dark) !important;
    background-color: var(--shiki-dark-bg) !important;
    font-style: var(--shiki-dark-font-style) !important;
    font-weight: var(--shiki-dark-font-weight) !important;
    text-decoration: var(--shiki-dark-text-decoration) !important;
  }
}

@layer utilities {
  @keyframes hello {
    50% {
      transform: translateY(-25%) rotateZ(15deg);
    }
  }

  @keyframes breath {
    to {
      scale: 0.8;
    }
  }

  @keyframes fade-in {
    to {
      opacity: 1;
    }
  }

  @keyframes fade-out {
    to {
      opacity: 0;
    }
  }

  .animation-hello {
    animation: hello 3s infinite ease;
  }

  .animation-fade-in {
    animation: fade-in 0.5s ease forwards;
  }

  .animation-fade-out {
    animation: fade-out 0.5s ease forwards;
  }

  .animation-breath {
    animation: breath ease 2s alternate infinite;
  }
}

/* Shiki 代码块统一样式 - 强制所有语言使用相同主题 */
.shiki,
pre.shiki,
code.shiki {
  @apply overflow-x-auto rounded-lg;
  @apply bg-slate-50 dark:bg-slate-900 !important;
  @apply border border-slate-200 dark:border-slate-800;
  @apply my-4 p-4;
  @apply font-mono text-sm;
}

/* 强制所有 shiki 代码块背景色一致，覆盖语言特定样式 */
.shiki,
.shiki span {
  background-color: rgb(248 250 252) !important;
}

:root.dark .shiki,
:root.dark .shiki span {
  background-color: rgb(15 23 42) !important;
}

.shiki .line {
  display: block;
  line-height: 1.6;
}

/* 统一代码块容器样式，移除额外的包装器样式差异 */
.shiki pre {
  @apply bg-transparent !important;
  margin: 0;
  padding: 0;
}

/* 隐藏代码块中的复选框、按钮等交互元素 */
.shiki input[type='checkbox'],
.shiki button,
.shiki .copy-button,
.shiki [role='button'] {
  display: none !important;
}

/* 行内代码样式 */
.inline-code {
  @apply rounded px-1.5 py-0.5 font-mono text-sm;
  @apply bg-slate-100 text-slate-800;
  @apply dark:bg-slate-800 dark:text-slate-200;
  @apply border border-slate-200 dark:border-slate-700;
  font-size: 0.875em;
  white-space: pre-wrap;
  word-break: break-word;
}

/* 隐藏行内代码的前后反引号（如果作为文本内容存在）*/
.inline-code::before,
.inline-code::after {
  content: none !important;
}

/* 行内代码在不同主题下的颜色统一 */
:root .inline-code {
  background-color: rgb(241 245 249);
  color: rgb(30 41 59);
  border-color: rgb(226 232 240);
}

:root.dark .inline-code {
  background-color: rgb(30 41 59);
  color: rgb(226 232 240);
  border-color: rgb(51 65 85);
}

/* 确保行内代码不会与其他元素样式冲突 */
p .inline-code,
li .inline-code,
td .inline-code {
  display: inline;
  vertical-align: baseline;
}

/* 数学公式样式调整 */
.katex {
  font-size: 1.1em;
}

.katex-display {
  @apply my-4 overflow-x-auto;
}

/* 表格样式增强（GFM 支持）*/
@layer components {
  .prose table {
    @apply w-full border-collapse;
  }

  .prose th {
    @apply bg-slate-50 font-semibold dark:bg-slate-800;
  }

  .prose td,
  .prose th {
    @apply border border-slate-200 px-4 py-2 dark:border-slate-700;
  }

  /* 任务列表样式 */
  .prose input[type='checkbox'] {
    @apply mr-2;
  }

  /* 删除线样式 */
  .prose del {
    @apply text-slate-400 dark:text-slate-600;
  }
}
